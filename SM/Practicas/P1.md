# SERVICIOS MULTIMEDIA 24/25: Práctica 1 - VoIP: Asterisk





![image](https://github.com/user-attachments/assets/97eb8252-f77a-442f-b92f-824b8f0db167)



**Apellidos y nombre**: Eloy Calvo Gens 

**Correo**: eloy.calvo.gens@udc.es

---

## Ejercicio 1: Configurar los clientes sip1 y sip2

Salida de `pjsip show endpoints`:

![image](https://github.com/user-attachments/assets/089914ac-8750-4a48-ae6b-64506b6426ec)

### ¿Cuál es el estado de los endpoints sip1 y sip2?

Los dos clientes se encuentran en estado "Not in use" como observamos en el campo "State"

### ¿En que direcciones IP y puertos se puede contactar con estos endpoints?

El par ip puerto para sip1 es 192.168.1.8:61230

El par ip puerto para sip2 es 192.168.1.8:61239

### ¿Cuantos contactos podrían registrarse como máximo para cada uno de los endpoints ¿Cómo lo sabes?

En ambos clientes el máximo es 1. (max_contacts=1 en pjsip_custom.conf)

---

## Ejercicio 2: Configurar los buzones de voz para sip1 y sip2

** COLOCAR FOTO DE `voicemail show users`**

---

## Ejercicio 3: Implementar la subrutina sub_recordcallinfo

 a) 
 ```
 ExecIf($[${ARG2}=BUSY]?Set(LOCAL(key)=b))
 ExecIf($[${ARG2}=CHANUNAVAIL]?Set(LOCAL(key)=u))
 ExecIf($[${ARG2}=NOANSWER]?Set(LOCAL(key)=n))
 ```
 
 b) ```Set(LOCAL(familykey)=calls_${ARG1}/${LOCAL(key)})```
 
 c) ```Set(DB(${LOCAL(familykey)})=$[${LOCAL(count)}+1])```
 
---

## Ejercicio 4: Implementar la subrutina sub_sipdial
 
 a) ```Dial(pjsip/${ARG1},${ARG2},${ARG3})```
 
 b) ```GoSub(sub_recordcallinfo,start,1(${ARG1},${DIALSTATUS}))```
 
 c) ```Goto(start,record)```

---

## Ejercicio 5:  Implementar las extensiones 001 y 002
 
 a) ```GoSub(sub_sipdial,start,1(sip1,10,))```
 
 b) ```GoSub(sub_sipdial,start,1(sip2,10,))```
 
**COLOCAR FOTO DE `database show calls_sip1` y `database show calls_sip2`**

 Sí, se registra correctamente la información de las llamadas
 
---

## Ejercicio 6: Implementar la subrutina sub_voicemail
 
 a) ```IF([${ARG2}=BUSY]?b:u))```
 
 b) ```voiceMail(${ARG1},${LOCAL(message)}${ARG3})```

---

## Ejercicio 7: Implementar la extensión 10X
 
 a) ```_10[1-2]```
 
 b) ```${EXTEN}```
 
 c) ```sip${EXTEN:2:1}```

 **AQUI PONER UNA FOTO DE `voicemail show users`**

  Sí, se están registrando correctamente los mensajes en el buzón de voz.

---

## Ejercicio 8: Implementar la extensión 120
 
 a) ```${CHANNEL(endpoint)}```
 
 b) ```GotoIf($[${LEN(${mailbox})}=0]?end)```
 
 c) ```VoiceMailMain(${mailbox})```

---

## Ejercicio 9: Implementar la extensión 99X
 
 a) ```_99[1-2]```
 
 b) 
 ```
 same => n,GoToIfTime(17:00-08:00,mon-fri,*,*?reject)
 same => n,GoToIfTime(*,sat-sun,*,*?reject)
 same => n,GoToIfTime(*,*,*,aug?reject)
 ```
 
 c) ```GoSub(sub_sipdial,start,1(${sip${EXTEN:2:1}},10,))```

---

## Ejercicio 10: Implementar la subrutina sub_getcallscount
 
 a) ```calls_${ARG1}/${ARG2})```
 
 b) ```${DB(${LOCAL(familykey)})})```
 
 c) ```Return(${LOCAL(count)})```


---

## Ejercicio 11:

**ESTE NO LO TENGO TODAVIA**

---
